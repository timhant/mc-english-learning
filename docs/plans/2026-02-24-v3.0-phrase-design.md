# MC English Learning v3.0 设计文档
*日期：2026-02-24*

## 概述
v3.0 包含两部分：
1. **v2.7 名词补充**：新增 83 个遗漏名词，总词数从 435 → 518
2. **v3.0 短语系统**：新增 ~150-180 条动作短语（Phase 2）

## Part 1: 名词补充（83 个）

### 新增实体（13 个）
| ID | en | cn | phonetic | level |
|----|----|----|----------|-------|
| minecraft:mooshroom | MOOSHROOM | 哞菇 | /ˈmuːʃruːm/ | 3 |
| minecraft:skeleton_horse | SKELETON HORSE | 骷髅马 | /ˈskelɪtən hɔːrs/ | 3 |
| minecraft:zombie_horse | ZOMBIE HORSE | 僵尸马 | /ˈzɒmbi hɔːrs/ | 3 |
| minecraft:zombie_villager_v2 | ZOMBIE VILLAGER | 僵尸村民 | /ˈzɒmbi ˈvɪlɪdʒər/ | 2 |
| minecraft:vindicator | VINDICATOR | 卫道士 | /ˈvɪndɪkeɪtər/ | 3 |
| minecraft:bogged | BOGGED | 沼骸 | /bɒɡd/ | 2 |
| minecraft:zoglin | ZOGLIN | 僵尸疣猪兽 | /ˈzɒɡlɪn/ | 4 |
| minecraft:tadpole | TADPOLE | 蝌蚪 | /ˈtædpoʊl/ | 2 |
| minecraft:trader_llama | TRADER LLAMA | 行商羊驼 | /ˈtreɪdər ˈlɑːmə/ | 2 |
| minecraft:creaking | CREAKING | 嘎枝 | /ˈkriːkɪŋ/ | 3 |
| minecraft:happy_ghast | HAPPY GHAST | 快乐恶魂 | /ˈhæpi ɡæst/ | 4 |
| minecraft:zombie_pigman | ZOMBIFIED PIGLIN | 僵尸猪灵 | /ˈzɒmbɪfaɪd ˈpɪɡlɪn/ | 4 |
| minecraft:evocation_illager | EVOKER | 唤魔者 | /ɪˈvoʊkər/ | 3 |

### 新增方块/物品 — 建筑常用（7 个）
| ID | en | cn | phonetic | level | type |
|----|----|----|----------|-------|------|
| minecraft:glass_pane | GLASS PANE | 玻璃板 | /ɡlæs peɪn/ | 2 | block |
| minecraft:iron_bars | IRON BARS | 铁栏杆 | /ˈaɪərn bɑːrz/ | 2 | block |
| minecraft:scaffolding | SCAFFOLDING | 脚手架 | /ˈskæfəldɪŋ/ | 3 | block |
| minecraft:hanging_sign | HANGING SIGN | 悬挂告示牌 | /ˈhæŋɪŋ saɪn/ | 3 | block |
| minecraft:item_frame | ITEM FRAME | 物品展示框 | /ˈaɪtəm freɪm/ | 2 | item |
| minecraft:trapped_chest | TRAPPED CHEST | 陷阱箱 | /træpt tʃest/ | 3 | block |
| minecraft:dried_kelp_block | DRIED KELP BLOCK | 干海带块 | /draɪd kelp blɒk/ | 2 | block |

### 新增食物（5 个）
| ID | en | cn | phonetic | level | type |
|----|----|----|----------|-------|------|
| minecraft:golden_carrot | GOLDEN CARROT | 金胡萝卜 | /ˈɡoʊldən ˈkærət/ | 3 | item |
| minecraft:baked_potato | BAKED POTATO | 烤马铃薯 | /beɪkt pəˈteɪtoʊ/ | 2 | item |
| minecraft:cooked_salmon | COOKED SALMON | 熟鲑鱼 | /kʊkt ˈsæmən/ | 2 | item |
| minecraft:cooked_cod | COOKED COD | 熟鳕鱼 | /kʊkt kɒd/ | 1 | item |
| minecraft:rabbit_stew | RABBIT STEW | 兔肉煲 | /ˈræbɪt stuː/ | 3 | item |

### 新增植物/花（11 个）
| ID | en | cn | phonetic | level | type |
|----|----|----|----------|-------|------|
| minecraft:red_flower.poppy | POPPY | 虞美人 | /ˈpɒpi/ | 1 | block |
| minecraft:yellow_flower | DANDELION | 蒲公英 | /ˈdændɪlaɪən/ | 1 | block |
| minecraft:red_flower.blue_orchid | BLUE ORCHID | 兰花 | /bluː ˈɔːrkɪd/ | 2 | block |
| minecraft:red_flower.cornflower | CORNFLOWER | 矢车菊 | /ˈkɔːrnflaʊər/ | 2 | block |
| minecraft:red_flower.lily_of_the_valley | LILY OF THE VALLEY | 铃兰 | /ˈlɪli əv ðə ˈvæli/ | 3 | block |
| minecraft:red_flower.allium | ALLIUM | 绒球葱 | /ˈæliəm/ | 2 | block |
| minecraft:red_flower.azure_bluet | AZURE BLUET | 茜草花 | /ˈæʒər ˈbluːɪt/ | 3 | block |
| minecraft:red_flower.oxeye_daisy | OXEYE DAISY | 滨菊 | /ˈɒksaɪ ˈdeɪzi/ | 3 | block |
| minecraft:red_flower.tulip | TULIP | 郁金香 | /ˈtjuːlɪp/ | 2 | block |
| minecraft:wither_rose | WITHER ROSE | 凋零玫瑰 | /ˈwɪðər roʊz/ | 4 | block |
| minecraft:cocoa_beans | COCOA BEANS | 可可豆 | /ˈkoʊkoʊ biːnz/ | 3 | item |

注意：Bedrock 中花的 ID 格式复杂。`red_flower` 带 data value 区分种类。
实际实现时需要检查 Bedrock 1.26+ 是否已将花拆分为独立 ID（如 `minecraft:poppy`）。
如果仍用 data value，blockLearn 需要通过 `block.permutation` 或 `block.type.id` 区分。

### 新增特殊植物（2 个）
| ID | en | cn | phonetic | level | type |
|----|----|----|----------|-------|------|
| minecraft:pitcher_plant | PITCHER PLANT | 瓶子草 | /ˈpɪtʃər plænt/ | 3 | block |
| minecraft:torchflower | TORCHFLOWER | 火把花 | /tɔːrtʃflaʊər/ | 3 | block |

### 新增树苗（7 个）
| ID | en | cn | phonetic | level | type |
|----|----|----|----------|-------|------|
| minecraft:oak_sapling | OAK SAPLING | 橡木树苗 | /oʊk ˈsæplɪŋ/ | 1 | block |
| minecraft:birch_sapling | BIRCH SAPLING | 白桦树苗 | /bɜːrtʃ ˈsæplɪŋ/ | 1 | block |
| minecraft:spruce_sapling | SPRUCE SAPLING | 云杉树苗 | /spruːs ˈsæplɪŋ/ | 2 | block |
| minecraft:jungle_sapling | JUNGLE SAPLING | 丛林树苗 | /ˈdʒʌŋɡl ˈsæplɪŋ/ | 3 | block |
| minecraft:dark_oak_sapling | DARK OAK SAPLING | 深色橡木树苗 | /dɑːrk oʊk ˈsæplɪŋ/ | 3 | block |
| minecraft:acacia_sapling | ACACIA SAPLING | 金合欢树苗 | /əˈkeɪʃə ˈsæplɪŋ/ | 3 | block |
| minecraft:cherry_sapling | CHERRY SAPLING | 樱花树苗 | /ˈtʃeri ˈsæplɪŋ/ | 3 | block |

### 新增红石（1 个）
| ID | en | cn | phonetic | level | type |
|----|----|----|----------|-------|------|
| minecraft:redstone_torch | REDSTONE TORCH | 红石火把 | /ˈredˌstoʊn tɔːrtʃ/ | 2 | block |

### 新增特殊植物补充（2 个）
| ID | en | cn | phonetic | level | type |
|----|----|----|----------|-------|------|
| minecraft:glow_berries | GLOW BERRIES | 荧光浆果 | /ɡloʊ ˈberiz/ | 3 | item |
| minecraft:torchflower_seeds | TORCHFLOWER SEEDS | 火把花种子 | /tɔːrtʃflaʊər siːdz/ | 3 | item |

### 新增交通（2 个）
| ID | en | cn | phonetic | level | type |
|----|----|----|----------|-------|------|
| minecraft:chest_boat | BOAT WITH CHEST | 运输船 | /boʊt wɪð tʃest/ | 2 | item |
| minecraft:chest_minecart | MINECART WITH CHEST | 运输矿车 | /ˈmaɪnkɑːrt wɪð tʃest/ | 2 | item |

### Level 分配汇总
- Level 1 (+5): cooked_cod, poppy, dandelion, oak_sapling, birch_sapling
- Level 2 (+16): zombie_villager, bogged, tadpole, trader_llama, glass_pane, iron_bars, baked_potato, cooked_salmon, dried_kelp_block, blue_orchid, cornflower, allium, tulip, spruce_sapling, redstone_torch, item_frame, chest_boat, chest_minecart
- Level 3 (+17): mooshroom, skeleton_horse, zombie_horse, vindicator, creaking, evocation_illager, scaffolding, hanging_sign, trapped_chest, golden_carrot, rabbit_stew, lily_of_the_valley, azure_bluet, oxeye_daisy, jungle_sapling, dark_oak_sapling, acacia_sapling, cherry_sapling, cocoa_beans, glow_berries, pitcher_plant, torchflower
- Level 4 (+4): zoglin, happy_ghast, zombie_pigman, wither_rose
- Level 5 (+0): 无新增

---

## Part 2: 短语系统（v3.0）

### 核心设计决策
1. **即时触发** — 动作发生时立即显示短语
2. **叠加增强** — 名词已学过才触发短语，否则先触发名词
3. **范围** — 击杀 + 挖掘 + 放置 + 天气/状态（4 类）
4. **展示** — ActionBar，去掉音标，格式：`§a§lKill a zombie §f击杀僵尸`
5. **共享冷却池** — 短语和名词共享 45 秒冷却，短语优先于名词

### 数据结构
```js
// 每个 level 的 phrases 数组
phrases: [
  {
    trigger: "kill",           // kill | break | place | weather | status
    entity: "minecraft:zombie", // for kill trigger
    block: undefined,          // for break/place trigger
    event: undefined,          // for weather/status trigger (rain|clear|thunder|fire|drowning)
    en: "Kill a zombie",
    cn: "击杀僵尸",
    requires: "minecraft:zombie"  // 前置名词 ID, null = 无前置
  }
]
```

### 触发模块
1. **phraseKill.js（新建）** — `world.afterEvents.entityDie` → 检查 damageSource
2. **blockLearn.js（扩展）** — 已有 break/place 事件，加短语层：已学名词→触发短语
3. **phraseEvent.js（新建）** — `weatherChange` + tick 检测 onfire/drowning

### 冷却机制
- 短语和名词共享冷却池（per-player per-word-id）
- 触发优先级：名词未学过 → 触发名词 | 名词已学过 → 触发短语
- 冷却时间 45 秒（CONFIG.cooldownSeconds）

### 短语词表（约 150-180 条）
短语将覆盖所有 5 个 level 的已有名词 + 新增名词，按触发类型分配：
- 击杀短语：~40 条（覆盖所有敌对生物）
- 挖掘短语：~50 条（覆盖所有矿石 + 常见方块）
- 放置短语：~40 条（覆盖工作台/火把/床等常用方块）
- 天气/状态：~15 条（rain/clear/thunder/fire/drowning/night/day）
- 食物相关（手持切换触发）：~15 条（Eat an apple / Drink milk）

具体短语列表将在实现阶段由 SubAgent 根据已有词表生成完整列表。

### 进度追踪
- 短语独立计数，但归属于所在 level
- `/words` 图鉴增加短语 tab
- Level 解锁条件不变（仍基于名词 80% 阈值），短语不影响升级

### 音频
- 每条短语需要 2 个音频文件（EN + CN），共 ~300-360 个 ogg
- 使用 Edge TTS（mc-tts-audio skill）
- 短语音频 ID 格式：`eng.phrase.kill_a_zombie_en` / `eng.phrase.kill_a_zombie_cn`

### 文件变更
- `vocab/level1-5.js` — 每个 level 新增 `phrases` 数组 + 新名词
- `phraseKill.js` — 新建
- `phraseEvent.js` — 新建
- `blockLearn.js` — 扩展短语触发
- `itemLearn.js` — 扩展食物短语触发
- `vocabulary.js` — 新增短语 lookup map
- `vocab/index.js` — 新增 phraseMap 导出
- `progress.js` — 短语进度追踪
- `voice.js` — 支持短语音频 ID
- `config.js` — 无变化（共享冷却）
- `main.js` — 注册新模块
- `sound_definitions.json` — 新增 ~300-360 条短语音频定义
- `manifest.json` — 版本号更新

### 实施顺序
1. 先完成 83 个名词补充 + 音频生成（v2.7）
2. 部署 v2.7 到 server1 验证
3. 实现短语系统框架（数据结构 + 触发 + 冷却）
4. 生成短语词表 + 音频
5. 部署 v3.0 到 server1 验证
6. 推送 GitHub
